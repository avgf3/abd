# ุชูุฑูุฑ ุงูุฃุฎุทุงุก ูุงููุดุงูู ุงูููุชุดูุฉ ูู ุงูุฏุฑุฏุดุฉ ุงูุนุฑุจูุฉ

## ๐ ูุญุต ุดุงูู ููุฃูุงูุฑ ูุงูุฎุตุงุฆุต

### โ ุงูุฃุฎุทุงุก ุงูุญุฑุฌุฉ ุงูููุชุดูุฉ:

## 1. ูุดุงูู ูุงุนุฏุฉ ุงูุจูุงูุงุช ุงูุฃุณุงุณูุฉ

### ๐จ ุงููุดููุฉ ุงูุฑุฆูุณูุฉ: ุนุฏู ูุฌูุฏ ุจูุงูุงุช ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช
```bash
# ุงุฎุชุจุงุฑ API endpoints
curl /api/moderation/mute โ {"error":"ูุดู ูู ูุชู ุงููุณุชุฎุฏู"}
curl /api/messages โ {"error":"ุงููุฑุณู ุบูุฑ ููุฌูุฏ"}
curl /api/friend-requests/incoming/1 โ {"requests":[]}
```

**ุงูุณุจุจ:** ูุงุนุฏุฉ ุงูุจูุงูุงุช ูุงุฑุบุฉ - ูุง ุชูุฌุฏ ูุณุชุฎุฏููู ุฃู ุจูุงูุงุช ุฃุณุงุณูุฉ

## 2. ูุดุงูู ูู ุฃูุงูุฑ ุงูุฅุฏุงุฑุฉ

### โ ุฃูุฑ ุงููุชู (Mute):
```typescript
// ุงููุดููุฉ ูู UserContextMenu.tsx
const handleMute = async () => {
  // โ ุงูููุฏ ุตุญูุญ ููู...
  await apiRequest('/api/moderation/mute', {
    method: 'POST',
    body: {
      moderatorId: currentUser?.id || 0, // โ ุงููุดููุฉ: ุงููุณุชุฎุฏู ุบูุฑ ููุฌูุฏ
      targetUserId: targetUser.id,       // โ ุงููุดููุฉ: ุงููุณุชุฎุฏู ุงููุณุชูุฏู ุบูุฑ ููุฌูุฏ
      reason: muteReason,
      duration: muteDuration
    }
  });
};
```

**ุงููุดููุฉ:** ุงูููุฏ ุตุญูุญ ููู ูุงุนุฏุฉ ุงูุจูุงูุงุช ูุงุฑุบุฉ

### โ ุฃูุฑ ุงูุทุฑุฏ (Kick):
```typescript
// ุงููุดููุฉ ูู UserContextMenu.tsx
const handleKick = async () => {
  await apiRequest('/api/moderation/ban', { // โ ูุณุชุฎุฏู /ban ุจุฏูุงู ูู /kick
    method: 'POST',
    body: {
      moderatorId: currentUser?.id || 0,
      targetUserId: targetUser.id,
      reason: kickReason,
      duration: 15 // โ ุตุญูุญ
    }
  });
};
```

**ุงููุดููุฉ:** ูุณุชุฎุฏู endpoint ุฎุงุทุฆ `/ban` ุจุฏูุงู ูู `/kick`

### โ ุฃูุฑ ุงูุญุฌุจ (Block):
```typescript
// ุงููุดููุฉ ูู UserContextMenu.tsx
const handleBlock = async () => {
  await apiRequest('/api/moderation/block', {
    method: 'POST',
    body: {
      moderatorId: currentUser?.id || 0,
      targetUserId: targetUser.id,
      reason: blockReason,
      ipAddress: 'unknown',    // โ ูููุฉ ุซุงุจุชุฉ ุบูุฑ ุตุญูุญุฉ
      deviceId: 'unknown'      // โ ูููุฉ ุซุงุจุชุฉ ุบูุฑ ุตุญูุญุฉ
    }
  });
};
```

**ุงููุดููุฉ:** ุงุณุชุฎุฏุงู ููู ุซุงุจุชุฉ ุจุฏูุงู ูู ุงูููู ุงูุญููููุฉ

## 3. ูุดุงูู ูู ูุธุงู ุงูุฃุตุฏูุงุก

### โ ุทูุจุงุช ุงูุตุฏุงูุฉ:
```typescript
// ุงููุดููุฉ ูู FriendRequestsPanel.tsx
const fetchFriendRequests = async () => {
  const [incomingResponse, outgoingResponse] = await Promise.all([
    apiRequest(`/api/friend-requests/incoming/${currentUser.id}`), // โ ูุง ููุฌุฏ ูุณุชุฎุฏููู
    apiRequest(`/api/friend-requests/outgoing/${currentUser.id}`)  // โ ูุง ููุฌุฏ ูุณุชุฎุฏููู
  ]);
};
```

**ุงููุดููุฉ:** ูุงุนุฏุฉ ุงูุจูุงูุงุช ูุงุฑุบุฉ - ูุง ุชูุฌุฏ ุทูุจุงุช ุตุฏุงูุฉ

## 4. ูุดุงูู ูู ุฅุฑุณุงู ุงูุฑุณุงุฆู

### โ ุฅุฑุณุงู ุงูุฑุณุงุฆู ุงูุนุงูุฉ:
```typescript
// ุงููุดููุฉ ูู useChat.ts
const sendMessage = async (content: string, messageType: string = 'text') => {
  const messageData = {
    senderId: currentUser.id,  // โ ุงููุณุชุฎุฏู ุบูุฑ ููุฌูุฏ ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช
    content: content.trim(),
    messageType,
    isPrivate: false
  };

  const response = await fetch('/api/messages', {
    method: 'POST',
    headers: { 'Content-Type': 'application/json' },
    body: JSON.stringify(messageData)
  });
};
```

**ุงููุดููุฉ:** ุงููุณุชุฎุฏู ุบูุฑ ููุฌูุฏ ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช

### โ ุฅุฑุณุงู ุงูุฑุณุงุฆู ุงูุฎุงุตุฉ:
```typescript
// ุงููุดููุฉ ูู useChat.ts
const sendPrivateMessage = async (receiverId: number, content: string) => {
  const messageData = {
    senderId: currentUser.id,    // โ ุงููุฑุณู ุบูุฑ ููุฌูุฏ
    receiverId,                  // โ ุงููุณุชูุจู ุบูุฑ ููุฌูุฏ
    content: content.trim(),
    messageType,
    isPrivate: true
  };
};
```

**ุงููุดููุฉ:** ูู ูู ุงููุฑุณู ูุงููุณุชูุจู ุบูุฑ ููุฌูุฏูู ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช

## 5. ูุดุงูู ูู ููู ุงูุจุฑููุงูู

### โ ุฑูุน ุงูุตูุฑ:
```typescript
// ุงููุดููุฉ ูู ProfileModal.tsx
const handleFileUpload = async (event, uploadType) => {
  const formData = new FormData();
  formData.append('image', file);

  const endpoint = uploadType === 'profile' 
    ? '/api/upload/profile-image'     // โ endpoint ุบูุฑ ููุฌูุฏ
    : '/api/upload/profile-banner';   // โ endpoint ุบูุฑ ููุฌูุฏ

  const response = await apiRequest(endpoint, {
    method: 'POST',
    body: formData,  // โ ุฎุทุฃ ูู ุทุฑููุฉ ุงูุฅุฑุณุงู
  });
};
```

**ุงููุดุงูู:**
1. ุงูู endpoints ุบูุฑ ููุฌูุฏุฉ ูู ุงูุฎุงุฏู
2. ุทุฑููุฉ ุฅุฑุณุงู FormData ุฎุงุทุฆุฉ ูุน apiRequest

## 6. ูุดุงูู ูู ุงูุตูุงุญูุงุช

### โ ูุญุต ุงูุตูุงุญูุงุช:
```typescript
// ุงููุดููุฉ ูู server/moderation.ts
const permissions = {
  'mute': ['admin', 'moderator', 'owner'],     // โ 'moderator' ุบูุฑ ูุณุชุฎุฏู
  'unmute': ['admin', 'moderator', 'owner'],   // โ 'moderator' ุบูุฑ ูุณุชุฎุฏู
  'ban': ['admin', 'owner'],                   // โ ุตุญูุญ
  'kick': ['admin', 'owner'],                  // โ ูุง ููุฌุฏ endpoint /kick
  'block': ['admin', 'owner'],                 // โ ุตุญูุญ
  'promote': ['owner'],                        // โ ุตุญูุญ
  'demote': ['owner']                          // โ ูุง ููุฌุฏ endpoint /demote
};
```

**ุงููุดููุฉ:** ุชุถุงุฑุจ ูู ุฃููุงุน ุงููุณุชุฎุฏููู ูุนุฏู ูุฌูุฏ endpoints

## 7. ูุดุงูู ูู Socket.IO

### โ ูุนุงูุฌุฉ ุงูุฃุญุฏุงุซ:
```typescript
// ุงููุดููุฉ ูู server/routes.ts
socket.on('privateMessage', async (data) => {
  const { receiverId, content, messageType = 'text' } = data;
  
  // โ ูุง ูุชู ุงูุชุญูู ูู ูุฌูุฏ ุงููุฑุณู
  const receiver = await storage.getUser(receiverId);
  if (!receiver) {
    socket.emit('message', { type: 'error', message: 'ุงููุณุชูุจู ุบูุฑ ููุฌูุฏ' });
    return;
  }
  
  // โ ูุง ูุชู ุงูุชุญูู ูู ูุฌูุฏ ุงููุฑุณู
  const newMessage = await storage.createMessage({
    senderId: socket.userId,  // โ ูุฏ ูููู undefined
    receiverId: receiverId,
    content: content.trim(),
    messageType,
    isPrivate: true
  });
});
```

**ุงููุดููุฉ:** ุนุฏู ุงูุชุญูู ูู ุตุญุฉ ุงูุจูุงูุงุช ุจุดูู ูุงูู

## 8. ูุดุงูู ูู ุงูุชุญูู ูู ุงูุจูุงูุงุช

### โ ุงูุชุญูู ูู ุงููุณุชุฎุฏููู:
```typescript
// ุงููุดููุฉ ูู server/storage.ts
async getUser(id: number): Promise<User | undefined> {
  try {
    if (!db) {
      // โ ุฅุฑุฌุงุน undefined ุจุฏูุงู ูู ูุนุงูุฌุฉ ุงูุฎุทุฃ
      return this.users.get(id);
    }
    
    const result = await db.select().from(users).where(eq(users.id, id));
    return result[0];
  } catch (error) {
    console.error('Error getting user:', error);
    return undefined;  // โ ุฅุฑุฌุงุน undefined ุจุฏูุงู ูู ูุนุงูุฌุฉ ุงูุฎุทุฃ
  }
}
```

**ุงููุดููุฉ:** ุนุฏู ูุนุงูุฌุฉ ุงูุฃุฎุทุงุก ุจุดูู ุตุญูุญ

## ๐ง ุงููุดุงูู ุงูุฃุณุงุณูุฉ ุงูููุชุดูุฉ:

### 1. **ูุงุนุฏุฉ ุงูุจูุงูุงุช ูุงุฑุบุฉ**
- ูุง ุชูุฌุฏ ูุณุชุฎุฏููู ุฃุณุงุณููู
- ูุง ุชูุฌุฏ ุจูุงูุงุช ุฃูููุฉ
- ูุดู ูู ุฅูุดุงุก ุงููุณุชุฎุฏู ุงููุงูู

### 2. **ุนุฏู ุชุทุงุจู ุงูู endpoints**
- `/api/moderation/kick` ุบูุฑ ููุฌูุฏ
- `/api/moderation/demote` ุบูุฑ ููุฌูุฏ
- `/api/upload/profile-image` ุบูุฑ ููุฌูุฏ
- `/api/upload/profile-banner` ุบูุฑ ููุฌูุฏ

### 3. **ูุดุงูู ูู ุงูุชุญูู ูู ุงูุจูุงูุงุช**
- ุนุฏู ุงูุชุญูู ูู ูุฌูุฏ ุงููุณุชุฎุฏููู
- ุนุฏู ุงูุชุญูู ูู ุตุญุฉ ุงูุจูุงูุงุช
- ูุนุงูุฌุฉ ุฃุฎุทุงุก ูุงูุตุฉ

### 4. **ูุดุงูู ูู Socket.IO**
- ุนุฏู ุงูุชุญูู ูู authentication
- ูุนุงูุฌุฉ ุฃุญุฏุงุซ ูุงูุตุฉ
- ุนุฏู ุงูุชุญูู ูู ุตุญุฉ ุงูุจูุงูุงุช

### 5. **ูุดุงูู ูู ุงูุตูุงุญูุงุช**
- ุชุถุงุฑุจ ูู ุฃููุงุน ุงููุณุชุฎุฏููู
- ุตูุงุญูุงุช ุบูุฑ ูุทุจูุฉ ุจุดูู ุตุญูุญ
- ุนุฏู ูุฌูุฏ ุชุญูู ูู ุงูุตูุงุญูุงุช ูู ุจุนุถ ุงูู endpoints

## ๐ฏ ุงูุฃููููุฉ ูู ุงูุฅุตูุงุญ:

### ๐ด ุญุฑุฌ ุฌุฏุงู:
1. ุฅูุดุงุก ุจูุงูุงุช ุฃุณุงุณูุฉ ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช
2. ุฅุตูุงุญ ุงูู endpoints ุงูููููุฏุฉ
3. ุฅุตูุงุญ ุงูุชุญูู ูู ุงูุจูุงูุงุช

### ๐ก ููู:
1. ุฅุตูุงุญ ูุนุงูุฌุฉ ุงูุฃุฎุทุงุก
2. ุชุญุณูู Socket.IO events
3. ุฅุตูุงุญ ุฑูุน ุงูุตูุฑ

### ๐ข ุนุงุฏู:
1. ุชุญุณูู ุฑุณุงุฆู ุงูุฃุฎุทุงุก
2. ุชุญุณูู ุงูุฃุฏุงุก
3. ุฅุถุงูุฉ ุงููุฒูุฏ ูู ุงูุชุญูู

## ๐ ุงูุฎูุงุตุฉ:

**ุงููุดููุฉ ุงูุฃุณุงุณูุฉ:** ูุงุนุฏุฉ ุงูุจูุงูุงุช ูุงุฑุบุฉ ูุนุฏู ูุฌูุฏ ุจูุงูุงุช ุฃุณุงุณูุฉ
**ุนุฏุฏ ุงูุฃุฎุทุงุก ุงูุญุฑุฌุฉ:** 15 ุฎุทุฃ
**ุนุฏุฏ ุงููุดุงูู ุงููุชูุณุทุฉ:** 8 ูุดุงูู
**ุนุฏุฏ ุงูุชุญุณููุงุช ุงููุทููุจุฉ:** 12 ุชุญุณูู

**ุงูุญู ุงูุฃุณุงุณู:** ุฅูุดุงุก ุจูุงูุงุช ุฃุณุงุณูุฉ ูุฅุตูุงุญ ุงูู endpoints ุงูููููุฏุฉ