# ุดุฑุญ ููุตู: ููู ูุชู ุญุณุงุจ ููุถุน ูู ุชุงุฌ

## ุงูููููู ุงูุฃุณุงุณู: `anchorY`

`anchorY` ูู **ููุทุฉ ุงูุงุฑุชูุงุฒ** - ุฃู ุฌุฒุก ูู ุงูุชุงุฌ ููุงูุณ ุฃุนูู ุงูุตูุฑุฉ

```
anchorY = 0    (ุงููููุฉ ุงูุงูุชุฑุงุถูุฉ)
โโโโโโโโโโโโโโโ
โ   ๐ ุงูุชุงุฌ   โ
โ             โ
โโโโโโโโโโโโโโโ  โ ุฃุณูู ุงูุชุงุฌ (100%) ููุงูุณ
โโโโโโโโโโโโโโโโ  โ ุฃุนูู ุงูุตูุฑุฉ
โโโโโโโโโโโโโโโ
โ   ุงูุตูุฑุฉ    โ


anchorY = 0.5  (ุงูููุชุตู)
โโโโโโโโโโโโโโโ
โ   ๐ ุงูุชุงุฌ   โ
โโโโโโโโโโโโโโโ  โ ููุชุตู ุงูุชุงุฌ (50%) ููุงูุณ
โโโโโโโโโโโโโโโโ  โ ุฃุนูู ุงูุตูุฑุฉ
โ   ุงูุตูุฑุฉ    โ


anchorY = 1.0  (ุฃุนูู ุงูุชุงุฌ)
      ๐        โ ุฃุนูู ุงูุชุงุฌ (0%) ููุงูุณ
โโโโโโโโโโโโโโโโ  โ ุฃุนูู ุงูุตูุฑุฉ
โโโโโโโโโโโโโโโ
โ   ุงูุตูุฑุฉ    โ
โ             โ
```

---

## ุงูุณููุงุฑูู 1: ุชุงุฌ ุนุงุฏู (anchorY = 0)

**ูุซุงู: tag3.webp**
```typescript
3: { widthRatio: 0.60, xAdjustPx: 0, yAdjustPx: 0, anchorY: 0, autoAnchor: true }
```

### ุฎุทูุงุช ุงูุญุณุงุจ:

#### 1๏ธโฃ ุญุณุงุจ ุนุฑุถ ุงูุชุงุฌ ุงููุนุฑูุถ:
```javascript
ุตูุฑุฉ: 56px
widthRatio: 0.60

tagWidth = 56 * 0.60 = 33.6px
```

#### 2๏ธโฃ ุญุณุงุจ ุงุฑุชูุงุน ุงูุชุงุฌ ุงููุนุฑูุถ:
```javascript
// ุงูุชุฑุถ ุงูุชุงุฌ ุงูุฃุตูู 600x400
tagNaturalWidth = 600px
tagNaturalHeight = 400px

scale = tagWidth / tagNaturalWidth
scale = 33.6 / 600 = 0.056

tagRenderedHeight = tagNaturalHeight * scale
tagRenderedHeight = 400 * 0.056 = 22.4px
```

#### 3๏ธโฃ ุญุณุงุจ ุงูุดูุงููุฉ ุงูุณูููุฉ (autoAnchor):
```javascript
// ุงูููุฏ ููุญุต ุงูุชุงุฌ ูู ุงูุฃุณูู ููุฃุนูู
// ูุจุญุซ ุนู ุฃูู pixel ุบูุฑ ุดูุงู

// ุงูุชุฑุถ: ุขุฎุฑ 80px ูู ุงูุชุงุฌ ุดูุงูุฉ
transparentBottom = 80px

bottomGapPx = transparentBottom * scale
bottomGapPx = 80 * 0.056 = 4.48px
```

#### 4๏ธโฃ ุญุณุงุจ ููุทุฉ ุงูุงุฑุชูุงุฒ:
```javascript
anchorY = 0  // ุฃุณูู ุงูุชุงุฌ

anchorFromLayout = anchorY * tagRenderedHeight
anchorFromLayout = 0 * 22.4 = 0px
```

#### 5๏ธโฃ ุงูุญุณุงุจ ุงูููุงุฆู (ุจุนุฏ ุงูุฅุตูุงุญ):
```javascript
yAdjustPx = 0  // ูุง ููุฌุฏ ุถุจุท ูุฏูู

anchorOffsetPx = yAdjustPx + anchorFromLayout - bottomGapPx
anchorOffsetPx = 0 + 0 - 4.48
anchorOffsetPx = -4.48px  โ ุณุงูุจ = ูุฑูุน ูุฃุนูู
```

#### 6๏ธโฃ ุงูููุถุน ุงูููุงุฆู:
```css
top: 0px  (ุฃุนูู ุงูุตูุฑุฉ)
transform: translate(-50%, calc(-100% + (-4.48px)))
         = translate(-50%, calc(-100% - 4.48px))
         = translate(-50%, -104.48px)
```

**ุงููุชูุฌุฉ:**
- ุงูุชุงุฌ ูุฑุชูุน 22.4px (ุงุฑุชูุงุนู ุงููุงูู)
- ุซู ูุฑุชูุน 4.48px ุฅุถุงููุฉ (ูุฅุฒุงูุฉ ุงูุดูุงููุฉ)
- โ **ุฃุณูู ุงูุฌุฒุก ุงููุฑุฆู ูู ุงูุชุงุฌ ููุงูุณ ุฃุนูู ุงูุตูุฑุฉ ุชูุงูุงู**

---

## ุงูุณููุงุฑูู 2: ุชุงุฌ ูุงุนุฏุชู ุชุฏุฎู ูู ุงูุตูุฑุฉ (anchorY > 0)

**ูุซุงู: tag4.webp**
```typescript
4: { widthRatio: 0.64, xAdjustPx: 0, yAdjustPx: 2, anchorY: 0.05, autoAnchor: true }
```

### ููุงุฐุง anchorY = 0.05ุ

**ุงูุณุจุจ:** ูุฐุง ุงูุชุงุฌ ูู ูุงุนุฏุฉ ูุฒุฎุฑูุฉ ูุฌุจ ุฃู ุชุฏุฎู ููููุงู ูู ุงูุตูุฑุฉ!

```
โโโโโโโโโโโโโโโ
โ   ๐ ุงูุชุงุฌ   โ
โ    โโโโโ    โ
โ    โ โ โ    โ โ ูุงุนุฏุฉ ูุฒุฎุฑูุฉ
โโโโโโดโโโโดโโโโโ
     โ 5% ูู ุงุฑุชูุงุน ุงูุชุงุฌ
โโโโโโโโโโโโโโโโ  โ ุฃุนูู ุงูุตูุฑุฉ
โโโโโโโโโโโโโโโ
โ   ุงูุตูุฑุฉ    โ
```

### ุฎุทูุงุช ุงูุญุณุงุจ:

#### 1๏ธโฃ ููุณ ุงูุฎุทูุงุช 1-3:
```javascript
tagWidth = 56 * 0.64 = 35.84px
scale = 35.84 / 600 = 0.0597
tagRenderedHeight = 400 * 0.0597 = 23.88px
bottomGapPx = 80 * 0.0597 = 4.78px
```

#### 2๏ธโฃ ุญุณุงุจ ููุทุฉ ุงูุงุฑุชูุงุฒ (ุงููุฎุชูู):
```javascript
anchorY = 0.05  // 5% ูู ุงูุฃุณูู

anchorFromLayout = 0.05 * tagRenderedHeight
anchorFromLayout = 0.05 * 23.88 = 1.19px
```

**ูุนูู ูุฐุง:**
- ุจุฏู ูุง ุฃุณูู ุงูุชุงุฌ ููุงูุณ ุฃุนูู ุงูุตูุฑุฉ
- ููุทุฉ ุนูู ุจุนุฏ 5% ูู ุงูุฃุณูู ุชูุงูุณ ุฃุนูู ุงูุตูุฑุฉ
- ูุนูู **1.19px ูู ูุงุนุฏุฉ ุงูุชุงุฌ ุชุฏุฎู ูู ุงูุตูุฑุฉ**

#### 3๏ธโฃ ุงูุญุณุงุจ ุงูููุงุฆู:
```javascript
yAdjustPx = 2  // ุถุจุท ูุฏูู 2px ููุฃุณูู

anchorOffsetPx = 2 + 1.19 - 4.78
anchorOffsetPx = -1.59px
```

#### 4๏ธโฃ ุงูููุถุน ุงูููุงุฆู:
```css
transform: translate(-50%, calc(-100% - 1.59px))
```

**ุงููุชูุฌุฉ:**
- ุงูุชุงุฌ ููุฒู 1.19px (anchorY)
- ููู ูุฑุชูุน 4.78px (autoAnchor)
- ุงูุตุงูู: ูุฑุชูุน 1.59px ุจุนุฏ ุงูุถุจุท
- โ **ุงููุงุนุฏุฉ ุงููุฒุฎุฑูุฉ ุชุฏุฎู 1.19px ูู ุงูุตูุฑุฉ**

---

## ุงูุณููุงุฑูู 3: ุชุงุฌ ูุญุชุงุฌ ุถุจุท ูุฏูู (yAdjustPx)

**ูุซุงู: tag6.webp**
```typescript
6: { widthRatio: 0.68, xAdjustPx: 0, yAdjustPx: 3, anchorY: 0.06, autoAnchor: true }
```

### ููุงุฐุง yAdjustPx = 3ุ

**ุงูุณุจุจ:** ุจุนุฏ ูู ุงูุญุณุงุจุงุชุ ุงูุชุงุฌ ูุณุง ุดูู ุนุงููุ ูุญุชุงุฌูู ููุฒูู 3px ูุฏูู.

### ุงูุญุณุงุจ:

```javascript
tagRenderedHeight = 25px  (ูุซุงู)
bottomGapPx = 5px
anchorFromLayout = 0.06 * 25 = 1.5px

// ุจุฏูู yAdjustPx:
offset = 0 + 1.5 - 5 = -3.5px  โ ุนุงูู ุดูู!

// ูุน yAdjustPx:
offset = 3 + 1.5 - 5 = -0.5px  โ ุชูุงู! โ
```

**yAdjustPx ููุฌุจ** = ููุฒู ุงูุชุงุฌ ููุฃุณูู (fine-tuning)

---

## ุฌุฏูู ุงูููุงุฑูุฉ: ูุจู ูุจุนุฏ ุงูุฅุตูุงุญ

| ุงูุชุงุฌ | anchorY | autoAnchor | ูุจู ุงูุฅุตูุงุญ | ุจุนุฏ ุงูุฅุตูุงุญ |
|------|---------|------------|--------------|--------------|
| tag1 | 0 | โ | โ ูุฏุฎู 5px | โ ููุงูุณ ุชูุงูุงู |
| tag2 | 0 | โ | โ ูุฏุฎู 4px | โ ููุงูุณ ุชูุงูุงู |
| tag3 | 0 | โ | โ ูุฏุฎู 3px | โ ููุงูุณ ุชูุงูุงู |
| tag4 | 0.05 | โ | โ ูุฏุฎู 7px | โ ูุฏุฎู 1.2px ููุท (ูุทููุจ) |
| tag5 | 0.04 | โ | โ ูุฏุฎู 5px | โ ูุฏุฎู 0.9px ููุท (ูุทููุจ) |
| tag6 | 0.06 | โ | โ ูุฏุฎู 9px | โ ูุฏุฎู 1.5px ููุท (ูุทููุจ) |

---

## ุงููุนุงุฏูุฉ ุงูููุงุฆูุฉ ุงููุงููุฉ

```javascript
// 1. ุญุณุงุจ ุงูููุงุณุงุช
tagWidth = imageSize * widthRatio
scale = tagWidth / tagNaturalWidth
tagRenderedHeight = tagNaturalHeight * scale

// 2. ุงูุดูุงููุฉ ุงูุณูููุฉ (ุฅุฐุง autoAnchor = true)
bottomGapPx = detectTransparentBottom(tagImage) * scale

// 3. ููุทุฉ ุงูุงุฑุชูุงุฒ
anchorFromLayout = (anchorY || 0) * tagRenderedHeight

// 4. ุงูุฅุฒุงุญุฉ ุงูููุงุฆูุฉ (ุจุนุฏ ุงูุฅุตูุงุญ)
anchorOffsetPx = yAdjustPx + anchorFromLayout - bottomGapPx
//               โ ุถุจุท ูุฏูู  โ ูุงุนุฏุฉ ุชุฏุฎู   โ ุฅุฒุงูุฉ ุงูุดูุงููุฉ

// 5. ุงูููุถุน ุงูููุงุฆู
top: imageTop
transform: translate(-50%, calc(-100% + anchorOffsetPx))
```

---

## ููุงุนุฏ ุงูุถุจุท ููู ุชุงุฌ ุฌุฏูุฏ:

### ุงูุฎุทูุฉ 1: ุงุจุฏุฃ ุจุงูุฅุนุฏุงุฏุงุช ุงูุงูุชุฑุงุถูุฉ
```typescript
newTag: { 
  widthRatio: 0.6,    // ุฌุฑูุจ ูู 0.55 ุฅูู 0.7
  xAdjustPx: 0, 
  yAdjustPx: 0, 
  anchorY: 0,         // ุงุจุฏุฃ ุจู 0
  autoAnchor: true    // ุฏุงุฆูุงู true
}
```

### ุงูุฎุทูุฉ 2: ุงุถุจุท widthRatio
- ุงูุชุญ test-tags.html
- ุดูู ุงูุชุงุฌ ูู ูุจูุฑ ุฃู ุตุบูุฑ
- ุนุฏูู widthRatio ุญุชู ูุตูุฑ ููุงุณุจ

### ุงูุฎุทูุฉ 3: ุดูู autoAnchor
- autoAnchor ูุดุชุบู ุชููุงุฆู
- ูุฒูู ุงูุดูุงููุฉ ุงูุณูููุฉ
- **ูุง ุชุนุทูู ุฅูุง ุฅุฐุง ูุง ุงุดุชุบู ุตุญ**

### ุงูุฎุทูุฉ 4: ุงุถุจุท anchorY (ุฅุฐุง ูุฒู)
- ุฅุฐุง ุงูุชุงุฌ ูู ูุงุนุฏุฉ ูุฒุฎุฑูุฉ ุชุญุชุงุฌ ุชุฏุฎู ูู ุงูุตูุฑุฉ:
  - anchorY = 0.03 ุฅูู 0.1
  - ูู 0.01 = ุญูุงูู 0.2-0.25px

### ุงูุฎุทูุฉ 5: ุงุถุจุท yAdjustPx (fine-tuning)
- ุจุนุฏ ูู ุดูุ ุฅุฐุง ูุณุง ุงูุชุงุฌ ูุด ูุถุจูุท:
  - yAdjustPx ููุฌุจ = ููุฒู ููุฃุณูู
  - yAdjustPx ุณุงูุจ = ูุฑูุน ูุฃุนูู
  - ุงุจุฏุฃ ูู -2 ุฅูู +3

---

## ูุซุงู ุนููู ูุงูู: ุถุจุท tag7

### ุงูุตูุฑุฉ ุงูุฃุตููุฉ:
```
tag7.webp: 800px ร 600px
ูุงุนุฏุฉ ุงูุชุงุฌ: 120px ูู ุงูุฃุณูู ุดูุงูุฉ
ุงููุงุนุฏุฉ ุงููุฒุฎุฑูุฉ: 15px ุงุฑุชูุงุนูุง
```

### ุงูุถุจุท ุงููุทููุจ:
```typescript
7: { 
  widthRatio: 0.64,   // ุงูุนุฑุถ ููุงุณุจ (36px ุนูู ุตูุฑุฉ 56px)
  xAdjustPx: 0,       // ูู ุงูููุชุตู
  yAdjustPx: 1,       // ููุฒู 1px ููุถุจุท
  anchorY: 0.02,      // ุงููุงุนุฏุฉ ุชุฏุฎู ุดูู (0.02 * 27 = 0.54px)
  autoAnchor: true    // ูุฒูู 120px ุงูุดูุงูุฉ
}
```

### ุงูุญุณุงุจ ุนูู ุตูุฑุฉ 56px:
```javascript
// 1. ุงูููุงุณุงุช
tagWidth = 56 * 0.64 = 35.84px
scale = 35.84 / 800 = 0.0448
tagRenderedHeight = 600 * 0.0448 = 26.88px

// 2. ุงูุดูุงููุฉ
bottomGapPx = 120 * 0.0448 = 5.38px

// 3. ููุทุฉ ุงูุงุฑุชูุงุฒ
anchorFromLayout = 0.02 * 26.88 = 0.54px

// 4. ุงููุชูุฌุฉ
anchorOffsetPx = 1 + 0.54 - 5.38 = -3.84px

// 5. ุงูููุถุน
transform: translateY(calc(-100% - 3.84px))
```

**ุงููุชูุฌุฉ:**
- โ ุงููุงุนุฏุฉ ุงููุฒุฎุฑูุฉ ุชุฏุฎู 0.54px ูู ุงูุตูุฑุฉ
- โ ุงูุดูุงููุฉ ูุญุฐููุฉ
- โ ุงูุถุจุท ุงููุฏูู 1px ููููุงู

---

## ุงููุฑู ุงูุฌููุฑู: ูุจู vs ุจุนุฏ

### โ ูุจู ุงูุฅุตูุงุญ:
```javascript
anchorOffsetPx = yAdjustPx + anchorFromLayout + bottomGapPx
//                                              โ ุฎุทุฃ!

// ูุซุงู tag1:
= 2 + 0 + 4.5 = 6.5px
transform: translateY(calc(-100% + 6.5px))
โ ุงูุชุงุฌ ููุฒู 6.5px ุฏุงุฎู ุงูุตูุฑุฉ โ
```

### โ ุจุนุฏ ุงูุฅุตูุงุญ:
```javascript
anchorOffsetPx = yAdjustPx + anchorFromLayout - bottomGapPx
//                                              โ ุตุญ!

// ููุณ ุงููุซุงู:
= 2 + 0 - 4.5 = -2.5px
transform: translateY(calc(-100% - 2.5px))
โ ุงูุชุงุฌ ูุฑุชูุน 2.5pxุ ููุงูุณ ุชูุงูุงู โ
```

---

**ุงูุชูู ุงูุดุฑุญ**
