# نظام البوتات - توثيق كامل

## نظرة عامة
تم إنشاء نظام بوتات متكامل يسمح لمالك الموقع بإضافة وإدارة البوتات من خلال لوحة التحكم. البوتات تظهر كمستخدمين عاديين في قائمة المتصلين ويمكن نقلها بين الغرف.

## المميزات المنفذة

### 1. قاعدة البيانات
- ✅ إنشاء جدول `bots` في قاعدة البيانات مع جميع الحقول المطلوبة
- ✅ إضافة فهارس لتحسين الأداء
- ✅ دعم تخزين إعدادات إضافية للبوتات (JSON)

### 2. API Endpoints
تم إنشاء مجموعة كاملة من API endpoints للبوتات:

- `GET /api/bots` - جلب قائمة البوتات
- `POST /api/bots` - إنشاء بوت جديد
- `PUT /api/bots/:id` - تحديث بيانات بوت
- `POST /api/bots/:id/move` - نقل بوت إلى غرفة أخرى
- `PATCH /api/bots/:id/toggle` - تفعيل/تعطيل بوت
- `DELETE /api/bots/:id` - حذف بوت
- `POST /api/bots/create-defaults` - إنشاء 10 بوتات افتراضية

### 3. واجهة المستخدم
- ✅ إضافة تبويب "نظام البوتات" في لوحة تحكم المالك
- ✅ واجهة جميلة وسهلة الاستخدام لإدارة البوتات
- ✅ عرض معلومات كاملة عن كل بوت (الاسم، الحالة، الغرفة، المستوى، النقاط)
- ✅ أزرار للتحكم السريع (تفعيل/تعطيل، تعديل، حذف، نقل)

### 4. التكامل مع النظام
- ✅ البوتات تظهر في قائمة المستخدمين المتصلين
- ✅ البوتات النشطة يتم تحميلها تلقائياً عند بدء الخادم
- ✅ إشعارات real-time عند دخول/خروج البوتات من الغرف
- ✅ البوتات لها ألوان مميزة (أخضر افتراضياً)

## أنواع البوتات

1. **بوت نظام (system)**: للمهام الإدارية والنظام
2. **بوت محادثة (chat)**: للتفاعل مع المستخدمين
3. **بوت مشرف (moderator)**: لمساعدة المشرفين

## البوتات الافتراضية

عند الضغط على "إنشاء 10 بوتات افتراضية"، يتم إنشاء:

1. بوت الترحيب - يرحب بالأعضاء الجدد
2. بوت المساعدة - يساعد في الإجابة على الأسئلة
3. بوت الألعاب - ينظم الألعاب والمسابقات
4. بوت الأخبار - ينشر آخر الأخبار والتحديثات
5. بوت النكت - يشارك النكت المضحكة
6. بوت الموسيقى - يشارك الموسيقى والأغاني
7. بوت الطقس - يخبر بحالة الطقس
8. بوت الرياضة - متابع للأحداث الرياضية
9. بوت الثقافة - يشارك المعلومات الثقافية
10. بوت الأمان - يحافظ على أمان الدردشة

## كيفية الاستخدام

### 1. الوصول لنظام البوتات
1. سجل دخول كمالك (owner)
2. افتح لوحة التحكم من القائمة الجانبية
3. اختر تبويب "نظام البوتات"

### 2. إضافة بوت جديد
1. اضغط على زر "إضافة بوت"
2. املأ البيانات المطلوبة:
   - اسم المستخدم (فريد)
   - كلمة المرور
   - الحالة (ما يظهر للمستخدمين)
   - الوصف
   - نوع البوت
   - لون الاسم
3. اضغط "إنشاء البوت"

### 3. إدارة البوتات
- **تفعيل/تعطيل**: اضغط على أيقونة التبديل
- **تعديل**: اضغط على أيقونة القلم
- **حذف**: اضغط على أيقونة سلة المهملات
- **نقل لغرفة أخرى**: اضغط "نقل لغرفة أخرى" واختر الغرفة

## الأمان والصلاحيات

- فقط المالك (owner) يمكنه الوصول لنظام البوتات
- كلمات مرور البوتات مشفرة في قاعدة البيانات
- جميع العمليات محمية بـ `protect.admin` middleware

## الملفات المضافة/المعدلة

### ملفات جديدة:
- `/workspace/shared/schema.ts` - إضافة جدول bots
- `/workspace/migrations/add-bots-table.sql` - migration لإنشاء الجدول
- `/workspace/client/src/components/chat/bots/BotsManagement.tsx` - مكون إدارة البوتات
- `/workspace/apply-bots-migration.js` - سكريبت لتطبيق migration

### ملفات معدلة:
- `/workspace/server/routes.ts` - إضافة API endpoints للبوتات
- `/workspace/server/database-adapter.ts` - إضافة دالة ensureBotsTable
- `/workspace/server/database-setup.ts` - استدعاء ensureBotsTable
- `/workspace/server/realtime.ts` - تحميل البوتات النشطة عند البدء
- `/workspace/client/src/components/chat/OwnerAdminPanel.tsx` - إضافة تبويب البوتات

## تطبيق Migration

لتطبيق migration البوتات على قاعدة البيانات:

```bash
node apply-bots-migration.js
```

أو يمكن أن يتم تطبيقها تلقائياً عند بدء الخادم.

## ملاحظات للتطوير المستقبلي

1. يمكن إضافة المزيد من أنواع البوتات
2. يمكن إضافة جدولة لتشغيل البوتات في أوقات محددة
3. يمكن إضافة ردود تلقائية للبوتات
4. يمكن إضافة إحصائيات لنشاط البوتات
5. يمكن إضافة واجهة برمجية للتحكم في البوتات خارجياً

## الخلاصة

تم تنفيذ نظام بوتات متكامل وجاهز للاستخدام مع جميع المتطلبات المذكورة:
- ✅ تبويب جديد في لوحة التحكم للمالك
- ✅ تسجيل البوتات في قاعدة البيانات الحقيقية
- ✅ إضافة البوتات لقائمة المتصلين
- ✅ التحكم الكامل بالبوتات من لوحة الإدارة
- ✅ نقل البوتات بين الغرف
- ✅ إمكانية إنشاء 10 بوتات افتراضية بضغطة واحدة