
> rest-express@1.0.0 start
> NODE_ENV=production node dist/index.js

[dotenv@17.2.1] injecting env (5) from .env -- tip: üì° observe env with Radar: https://dotenvx.com/radar
The `fetchConnectionCache` option is deprecated (now always `true`)
[dotenv@17.2.1] injecting env (0) from .env -- tip: üîê encrypt with Dotenvx: https://dotenvx.com
{
  severity_local: 'NOTICE',
  severity: 'NOTICE',
  code: '42P06',
  message: 'schema "drizzle" already exists, skipping',
  file: 'schemacmds.c',
  line: '132',
  routine: 'CreateSchemaCommand'
}
{
  severity_local: 'NOTICE',
  severity: 'NOTICE',
  code: '42P07',
  message: 'relation "__drizzle_migrations" already exists, skipping',
  file: 'parse_utilcmd.c',
  line: '207',
  routine: 'transformCreateStmt'
}
{
  severity_local: 'NOTICE',
  severity: 'NOTICE',
  code: '42P07',
  message: 'relation "room_users" already exists, skipping',
  file: 'parse_utilcmd.c',
  line: '207',
  routine: 'transformCreateStmt'
}
{
  severity_local: 'NOTICE',
  severity: 'NOTICE',
  code: '42P07',
  message: 'relation "rooms" already exists, skipping',
  file: 'parse_utilcmd.c',
  line: '207',
  routine: 'transformCreateStmt'
}
{
  severity_local: 'NOTICE',
  severity: 'NOTICE',
  code: '42P07',
  message: 'relation "wall_posts" already exists, skipping',
  file: 'parse_utilcmd.c',
  line: '207',
  routine: 'transformCreateStmt'
}
{
  severity_local: 'NOTICE',
  severity: 'NOTICE',
  code: '42P07',
  message: 'relation "wall_reactions" already exists, skipping',
  file: 'parse_utilcmd.c',
  line: '207',
  routine: 'transformCreateStmt'
}
‚ùå Error running migrations: DrizzleQueryError: Failed query: 
ALTER TABLE "rooms" ADD CONSTRAINT "rooms_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "public"."users"("id") ON DELETE no action ON UPDATE no action;
params: 
    at PostgresJsPreparedQuery.queryWithCache (file:///workspace/node_modules/drizzle-orm/pg-core/session.js:42:15)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async file:///workspace/node_modules/drizzle-orm/pg-core/dialect.js:64:13
    at async scope (file:///workspace/node_modules/postgres/src/index.js:260:18)
    at async Function.begin (file:///workspace/node_modules/postgres/src/index.js:243:14)
    at async PgDialect.migrate (file:///workspace/node_modules/drizzle-orm/pg-core/dialect.js:60:5)
    at async migrate (file:///workspace/node_modules/drizzle-orm/postgres-js/migrator.js:4:3)
    at async runMigrations (file:///workspace/dist/index.js:6491:5)
    at async file:///workspace/dist/index.js:6983:7 {
  query: '\n' +
    'ALTER TABLE "rooms" ADD CONSTRAINT "rooms_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "public"."users"("id") ON DELETE no action ON UPDATE no action;',
  params: [],
  cause: PostgresError: constraint "rooms_created_by_users_id_fk" for relation "rooms" already exists
      at ErrorResponse (file:///workspace/node_modules/postgres/src/connection.js:794:26)
      at handle (file:///workspace/node_modules/postgres/src/connection.js:480:6)
      at Socket.data (file:///workspace/node_modules/postgres/src/connection.js:315:9)
      at Socket.emit (node:events:518:28)
      at addChunk (node:internal/streams/readable:561:12)
      at readableAddChunkPushByteMode (node:internal/streams/readable:512:3)
      at Readable.push (node:internal/streams/readable:392:5)
      at TCP.onStreamRead (node:internal/stream_base_commons:189:23) {
    severity_local: 'ERROR',
    severity: 'ERROR',
    code: '42710',
    file: 'tablecmds.c',
    line: '9354',
    routine: 'ATExecAddConstraint'
  }
}
‚ùå Migration failed - stopping application
‚úÖ Manual table creation completed
üîß Checking for missing columns...
‚úÖ Added missing role column
‚úÖ Missing columns check completed
‚úÖ Owner already exists
[2025-08-03T22:07:29.886Z] PROD: ‚úÖ Database initialization completed successfully
