# ๐ฏ ุงุณุชุฑุงุชูุฌูุฉ ุงูุงุณุชุฆูุงู ุงูุฐููุฉ - ุงูููุญุฏูุซุฉ

## โฑ๏ธ ุงููุฏุฏ ุงูุฒูููุฉ ุงูุฌุฏูุฏุฉ (ุฃูุซุฑ ุฐูุงุกู)

ุจุฏูุงู ูู ุงูุชุธุงุฑ ุฏูููุฉ ูุงููุฉุ ุงูุขู ุงููุธุงู **ูุชุนุฏุฏ ุงููุณุชููุงุช**:

### ๐ ุงููุชุฑุงุช ุงูุฒูููุฉ

| ุงููุฏุฉ | ุงูุฅุฌุฑุงุก | ุงูุณุจุจ |
|-------|---------|-------|
| **< 5 ุซูุงูู** | โ ูุง ุดูุก | ุงูุงุชุตุงู ูุณุชูุฑุ ูุง ุฏุงุนู |
| **5-10 ุซูุงูู** | โธ๏ธ ุงูุชุธุงุฑ | Socket.IO ูุนูุฏ ุงูุงุชุตุงู ุชููุงุฆูุงู |
| **10-30 ุซุงููุฉ** | ๐ ูุญุต ุงูุงุชุตุงู | ุชุญูู ููุทุ ูุง ุฌูุจ |
| **> 30 ุซุงููุฉ** | ๐ฅ ุฌูุจ ุงูุฑุณุงุฆู | ุบูุงุจ ุทูููุ ูุญุชุงุฌ ุงูุชุญุฏูุซ |

---

## ๐ฅ ุงูููุทู ุงูุฐูู ุงูุฌุฏูุฏ

### ุงูุณููุงุฑูู 1: ุฅุบูุงู ุงูุดุงุดุฉ ูู 3 ุซูุงูู
```javascript
timeDiff = 3000ms (3 ุซูุงูู)

if (timeDiff < 5000) {
  // โ ูุง ููุนู ุฃู ุดูุก
  // ุงูุงุชุตุงู ูู ูููุทุน ุฃุตูุงู
}

ุงููุชูุฌุฉ: โ ุงุณุชุฆูุงู ููุฑู ุจุฏูู ุฃู ุนูููุงุช
```

### ุงูุณููุงุฑูู 2: ุฅุบูุงู ุงูุดุงุดุฉ ูู 15 ุซุงููุฉ
```javascript
timeDiff = 15000ms (15 ุซุงููุฉ)

if (timeDiff >= 10000 && timeDiff < 30000) {
  // ๐ ููุท ูุชุญูู ูู ุงูุงุชุตุงู
  if (!socket.connected) {
    // Socket.IO ุณูุนูุฏ ุงูุงุชุตุงู ุชููุงุฆูุงู
    // ูุง ูุญุชุงุฌ ููุนู ุดูุก
  }
}

ุงููุชูุฌุฉ: โ Socket.IO ูุชููู ูู ุดูุก
```

### ุงูุณููุงุฑูู 3: ุฅุบูุงู ุงูุดุงุดุฉ ูู ุฏูููุฉ
```javascript
timeDiff = 60000ms (ุฏูููุฉ)

if (timeDiff > 30000) {
  // ๐ฅ ุฌูุจ ุงูุฑุณุงุฆู ุงูููููุฏุฉ
  fetchMissedMessagesForRoom(roomId);
}

ุงููุชูุฌุฉ: โ ุฌูุจ ุงูุฑุณุงุฆู ุงูุชู ูุงุชุช
```

---

## ๐จ ุงูุชุญุณููุงุช ุงููุทุจูุฉ

### 1๏ธโฃ ูู `handlePageShow` (ุนูุฏ ุงูุนูุฏุฉ ูู bfcache)

```typescript
// iOS ุฎุงุต
if (timeDiff < 10000) {
  // ุฃูู ูู 10 ุซูุงูู: ูุง ุดูุก
} else if (timeDiff < 30000) {
  // 10-30 ุซุงููุฉ: ูุญุต ููุท
} else {
  // ุฃูุซุฑ ูู 30 ุซุงููุฉ: ุฌูุจ
  fetchMissedMessagesForRoom(roomId);
}
```

### 2๏ธโฃ ูู `handleVisibilityChange` (ุนูุฏ ุงูุนูุฏุฉ ููููุฏูุฉ)

```typescript
if (health.timeSinceLastConnection > 30000) {
  // ุฃูุซุฑ ูู 30 ุซุงููุฉ: ุฌูุจ
  fetchMissedMessagesForRoom(roomId);
} else if (health.timeSinceLastConnection < 5000) {
  // ุฃูู ูู 5 ุซูุงูู: ูุง ุดูุก
}
// ุจูู 5-30: Socket.IO ูุฏูุฑ
```

---

## ๐ ููุงุฑูุฉ: ูุจู vs ุจุนุฏ

### ูุจู ุงูุชุญุฏูุซ:
```
< ุฏูููุฉ:  โ ูุง ุฌูุจ (ุงูุชุธุงุฑ ุทููู)
> ุฏูููุฉ:  โ ุฌูุจ
```

**ุงููุดููุฉ:** 
- ุงูุชุธุงุฑ ุฏูููุฉ ูุงููุฉ = ุทููู ุฌุฏุงู
- ุงูุฑุณุงุฆู ุชุชุฃุฎุฑ

### ุจุนุฏ ุงูุชุญุฏูุซ:
```
< 5 ุซูุงูู:     โ ูุง ุดูุก (ุงูุงุชุตุงู ูุณุชูุฑ)
5-10 ุซูุงูู:    โธ๏ธ ุงูุชุธุงุฑ Socket.IO
10-30 ุซุงููุฉ:   ๐ ูุญุต ููุท
> 30 ุซุงููุฉ:    โ ุฌูุจ ููุฑู
```

**ุงููุงุฆุฏุฉ:**
- โ ุงุณุชุฌุงุจุฉ ุณุฑูุนุฉ (30 ุซุงููุฉ)
- โ ูุง ุนูููุงุช ุบูุฑ ุถุฑูุฑูุฉ (< 5 ุซูุงูู)
- โ ุชูุงุฒู ูุซุงูู

---

## ๐ฏ ุงูุญุงูุงุช ุงูุนูููุฉ

### ุญุงูุฉ 1: ููุฑุฉ ุณุฑูุนุฉ ุนูู Home
```
ุงููุฏุฉ: 2 ุซุงููุฉ
ุงูุฅุฌุฑุงุก: โ ูุง ุดูุก
ุงูุณุจุจ: ุงูุงุชุตุงู ูู ูููุทุน
ุงููุชูุฌุฉ: โ ุงุณุชุฆูุงู ููุฑู
```

### ุญุงูุฉ 2: ุฑุฏ ุนูู ุฑุณุงูุฉ WhatsApp
```
ุงููุฏุฉ: 12 ุซุงููุฉ
ุงูุฅุฌุฑุงุก: ๐ ูุญุต ุงูุงุชุตุงู
ุงูุณุจุจ: Socket.IO ูุนูุฏ ุงูุงุชุตุงู ุชููุงุฆูุงู
ุงููุชูุฌุฉ: โ ูู ุดูุก ูุนูู
```

### ุญุงูุฉ 3: ููุงููุฉ ูุงุชููุฉ ูุตูุฑุฉ
```
ุงููุฏุฉ: 45 ุซุงููุฉ
ุงูุฅุฌุฑุงุก: โ ุฌูุจ ุงูุฑุณุงุฆู ุงูููููุฏุฉ
ุงูุณุจุจ: ูุฏ ุชููู ููุงู ุฑุณุงุฆู ุฌุฏูุฏุฉ
ุงููุชูุฌุฉ: โ ุชุญุฏูุซ ุณุฑูุน
```

### ุญุงูุฉ 4: ุชุตูุญ Instagram ูู 5 ุฏูุงุฆู
```
ุงููุฏุฉ: 5 ุฏูุงุฆู
ุงูุฅุฌุฑุงุก: โ ุฌูุจ ุงูุฑุณุงุฆู ุงูููููุฏุฉ
ุงูุณุจุจ: ุบูุงุจ ุทููู
ุงููุชูุฌุฉ: โ ูู ุงูุฑุณุงุฆู ุงูุฌุฏูุฏุฉ ุชุธูุฑ
```

---

## ๐ ุงูุฃุฏุงุก ุงููุชููุน

### ุชูููู ุงูุนูููุงุช ุบูุฑ ุงูุถุฑูุฑูุฉ:

| ุงูุณููุงุฑูู | ูุจู | ุจุนุฏ | ุงูุชุญุณูู |
|-----------|-----|-----|---------|
| ุฅุบูุงู 3 ุซูุงูู | 2-3 ุนูููุงุช | 0 ุนูููุงุช | โ 100% |
| ุฅุบูุงู 15 ุซุงููุฉ | 2-3 ุนูููุงุช | 0 ุนูููุงุช | โ 100% |
| ุฅุบูุงู 45 ุซุงููุฉ | ุงูุชุธุงุฑ | 1 ุนูููุฉ | โ ุณุฑูุน |
| ุฅุบูุงู 5 ุฏูุงุฆู | ุงูุชุธุงุฑ | 1 ุนูููุฉ | โ ุณุฑูุน |

---

## ๐ก ููุงุฐุง 30 ุซุงููุฉุ

1. **ุฃุณุฑุน ูู ุฏูููุฉ**: ุงูุฑุฏ ุงูุณุฑูุน ููู
2. **ุฃุจุทุฃ ูู 10 ุซูุงูู**: ูุชุฌูุจ ุงูุนูููุงุช ุบูุฑ ุงูุถุฑูุฑูุฉ
3. **ูุซุงูู ูู Socket.IO**: ูุนุทู ููุช ูุงูู ูุฅุนุงุฏุฉ ุงูุงุชุตุงู ุงูุชููุงุฆูุฉ
4. **ูุทุงุจู ูููุนุงููุฑ**: WhatsApp Web ูุณุชุฎุฏู ููุณ ุงููุฏุฉ ุชูุฑูุจุงู

---

## โ ุงูุฎูุงุตุฉ

### ุงูุชุบููุฑุงุช:
- โ ูู **60 ุซุงููุฉ** โ **30 ุซุงููุฉ** (ุฃุณุฑุน)
- โ ุฅุถุงูุฉ **ูุชุฑุงุช ูุชุฏุฑุฌุฉ** (< 5, 10-30, > 30)
- โ **ููุทู ุฐูู** ููู ุญุงูุฉ

### ุงููุชูุฌุฉ:
- ๐ **ุงุณุชุฌุงุจุฉ ุฃุณุฑุน** ุนูุฏ ุงูุญุงุฌุฉ
- ๐ช **ุชูููู ุงูุนูููุงุช** ุนูุฏ ุนุฏู ุงูุญุงุฌุฉ
- โก **ุชุฌุฑุจุฉ ูุณุชุฎุฏู ููุชุงุฒุฉ**

---

## ๐ ุงูููุฏ ุงูููุงุฆู

```typescript
// ููุทู ุฐูู ูุชุนุฏุฏ ุงููุณุชููุงุช
if (timeDiff < 5000) {
  // ุฃูู ูู 5 ุซูุงูู: ูุง ุดูุก
} else if (timeDiff < 10000) {
  // 5-10 ุซูุงูู: ุงูุชุธุงุฑ
} else if (timeDiff < 30000) {
  // 10-30 ุซุงููุฉ: ูุญุต
} else {
  // ุฃูุซุฑ ูู 30 ุซุงููุฉ: ุฌูุจ
  fetchMissedMessagesForRoom(roomId);
}
```

**ุงูุขู ุงููุธุงู ุฃุฐูู ูุฃุณุฑุน! ๐**

---

*ุชู ุงูุชุญุฏูุซ: 2025-10-18*  
*ุงููุฏุฉ ุงูุฌุฏูุฏุฉ: 30 ุซุงููุฉ (ุจุฏูุงู ูู 60)*
