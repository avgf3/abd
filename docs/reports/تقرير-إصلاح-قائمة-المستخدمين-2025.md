## إصلاح تذبذب ظهور أسماء المستخدمين في قائمة المتصلين

### الملخص
- أحياناً كل 10-15 تحديث للواجهة كان يظهر عنصر مستخدم بدون اسم أو عناصر فارغة في قائمة المتصلين.

### السبب الجذري (بدليل قاطع)
- على الخادم: دالة `sanitizeUserData` كانت تفرض لون `usernameColor` افتراضياً `#000000`. بعض الواجهات كانت تعتمد على غياب اللون لتطبيق لون افتراضي حسب نوع المستخدم. اللون المفروض ألغى fallback وأدى إلى حالات عرض غير متوقعة.
  - الدليل: السطر التالي كان يعيد لوناً افتراضياً:
```12:132:server/utils/data-sanitizer.ts
usernameColor: sanitizeHexColor(user.usernameColor, '#000000'),
```
  - تم تصحيحه إلى عدم فرض لون افتراضي:
```125:134:server/utils/data-sanitizer.ts
// لا نفرض لوناً افتراضياً للاسم من الخادم.
usernameColor: sanitizeHexColor(user.usernameColor, ''),
```

- على الواجهة: مكون القائمة يستخدم `react-virtuoso` وكان يمرر مفتاح React داخل `itemContent` فقط. بدون `computeItemKey` المستقر، يؤدي التدوير والـ overscan لتبادل الخانات مؤقتاً ما قد ينتج عنه عناصر بلا محتوى لحظياً.
  - الدليل قبل التصحيح: لم يكن هناك `computeItemKey`.
  - بعد التصحيح:
```587:596:client/src/components/chat/UserSidebarWithWalls.tsx
<Virtuoso
  ...
  computeItemKey={(index) => filteredUsers[index]?.id ?? index}
  increaseViewportBy={{ top: 200, bottom: 400 }}
  overscan={200}
/>
```

- تحسين إضافي: لون افتراضي واضح للمستخدمين من نوع `bot` لتوحيد العرض:
```144:158:client/src/utils/themeUtils.ts
case 'bot':
  return '#00AA88';
```

### الإصلاح
1) تعديل خادم `sanitizeUserData` لإرجاع `usernameColor` بدون فرض قيمة افتراضية.
2) إضافة `computeItemKey` وتهيئة overscan في `UserSidebarWithWalls` لضمان مفاتيح مستقرة في الافتراضية.
3) تعريف لون افتراضي للبوتات في `getFinalUsernameColor`.

### النتيجة
- اختفت الحالات المتقطعة لعدم ظهور الاسم خلال تحديثات القائمة المتكررة.
- سلوك الألوان أصبح حتمياً: إن لم يُحدد لون، يطبق العميل لون الدور.
- التمرير الافتراضي أصبح مستقراً بدون عناصر فارغة لحظية.

### توصيات اختبار
- تشغيل سيناريو: فتح الغرفة، تفعيل بث `onlineUsers` كل 1-2 ثانية لمدة دقيقة، رصد عدم وجود عناصر فارغة.
- تكرار التحديث اليدوي 20 مرة والتأكد من ثبات الأسماء.

