# ุงูุฅุตูุงุญ ุงูููุงุฆู ููุดููุฉ ุงููุทุงุน ูุงุนุฏุฉ ุงูุจูุงูุงุช

## ๐ **ุงูุณุจุจ ุงูุญูููู ูููุดููุฉ:**
ุงููุดููุฉ ูุงูุช ูู **Supabase Pooler** ุงูุฐู ูุฏูู ุญุฏูุฏ ุตุงุฑูุฉ:
- โ **ุงุชุตุงู ูุงุญุฏ ููุท** ูู ุงูุฎุทุฉ ุงููุฌุงููุฉ
- โ **timeout ูุตูุฑ** ููุงุชุตุงูุงุช ุงูุฎุงููุฉ
- โ **ุฅุนุงุฏุฉ ุชุฏููุฑ ูุณุฑู** ููุงุชุตุงูุงุช ุงูุทูููุฉ
- โ **ุญุฏูุฏ ุตุงุฑูุฉ** ุนูู ุนุฏุฏ ุงูุงุชุตุงูุงุช ุงููุชุฒุงููุฉ

## ๐๏ธ **ุงูุญู ุงูููุงุฆู ุงููุทุจู:**

### 1. **ูุธุงู ุงูุงุชุตุงู ุนูุฏ ุงูุทูุจ (On-Demand Connection)**
```typescript
// ุจุฏูุงู ูู ุงูุงุญุชูุงุธ ุจุงุชุตุงู ุฏุงุฆู
// ููุดุฆ ุงุชุตุงู ููุท ุนูุฏ ุงูุญุงุฌุฉ ููุบููู ุจุนุฏ ุงูุงุณุชุนูุงู

async function createConnectionOnDemand(): Promise<boolean> {
  // ุฅูุดุงุก ุงุชุตุงู ุฌุฏูุฏ ููุท ุนูุฏ ุงูุทูุจ
  // ุฅุบูุงูู ููุฑุงู ุจุนุฏ ุงูุงุณุชุนูุงู
}
```

### 2. **ุฅุนุฏุงุฏุงุช ูุญุณูุฉ ุฎุตูุตุงู ูู Supabase**
```typescript
const client = postgres(connectionString, {
  max: 1,                    // ุงุชุตุงู ูุงุญุฏ ููุท
  idle_timeout: 20,          // timeout ูุตูุฑ
  connect_timeout: 10,       // ุงุชุตุงู ุณุฑูุน
  max_lifetime: 60 * 5,      // ุฅุนุงุฏุฉ ุชุฏููุฑ ูู 5 ุฏูุงุฆู
  prepare: false,            // ุชุนุทูู prepared statements
  keep_alive: false,         // ุชุนุทูู keep-alive
  retry_delay: 500,          // ุฅุนุงุฏุฉ ูุญุงููุฉ ุณุฑูุนุฉ
  max_retries: 5,            // ูุญุงููุงุช ูุชุนุฏุฏุฉ
});
```

### 3. **ุฅุฏุงุฑุฉ ุฐููุฉ ููุงุชุตุงูุงุช**
- โ **ุฅูุดุงุก ุงุชุตุงู** ุนูุฏ ูู ุงุณุชุนูุงู
- โ **ุฅุบูุงู ููุฑู** ุจุนุฏ ุงูุงุณุชุนูุงู
- โ **ุนุฏู ุงูุงุญุชูุงุธ** ุจุงุชุตุงูุงุช ุฎุงููุฉ
- โ **ุชูููุฑ ุงูููุงุฑุฏ** ูุชุฌูุจ ุชุฌุงูุฒ ุงูุญุฏูุฏ

### 4. **ูุธุงู ุฅุนุงุฏุฉ ุงููุญุงููุฉ ุงููุญุณู**
```typescript
export async function executeWithRetry<T>(
  queryFn: () => Promise<T>,
  maxRetries?: number
): Promise<T> {
  // ุฅูุดุงุก ุงุชุตุงู ุนูุฏ ุงูุทูุจ
  // ุฅุนุงุฏุฉ ุงููุญุงููุฉ ุนูุฏ ุงููุดู
  // ุฅุบูุงู ุงูุงุชุตุงู ุจุนุฏ ุงูุงุณุชุนูุงู
}
```

## ๐ **ุงููุชุงุฆุฌ ุงููุชููุนุฉ:**

### โ **ูุจู ุงูุฅุตูุงุญ:**
- โ ุงููุทุงุน ูุณุชูุฑ ููุงุชุตุงู
- โ ุชุฌุงูุฒ ุญุฏูุฏ Supabase
- โ timeout ูุชูุฑุฑ
- โ ุงุณุชููุงู ููุงุฑุฏ ุนุงูู

### โ **ุจุนุฏ ุงูุฅุตูุงุญ:**
- โ **ุงุณุชูุฑุงุฑ ูุงูู** ููุงุชุตุงู
- โ **ุนุฏู ุชุฌุงูุฒ** ุญุฏูุฏ Supabase
- โ **ุงุชุตุงู ุนูุฏ ุงูุทูุจ** ููุท
- โ **ุชูููุฑ ุงูููุงุฑุฏ** ุจุดูู ูุซุงูู

## ๐ง **ุงููุชุบูุฑุงุช ุงูุจูุฆูุฉ ุงูุฌุฏูุฏุฉ:**
```env
DB_MAX_CONNECTIONS=1          # ุงุชุตุงู ูุงุญุฏ ููุท
DB_HEALTH_CHECK_INTERVAL=15000 # ูุญุต ูู 15 ุซุงููุฉ
DB_RETRY_ATTEMPTS=5           # 5 ูุญุงููุงุช ุฅุนุงุฏุฉ
```

## ๐ **ููููุฉ ุงูุงุณุชุฎุฏุงู:**
```typescript
import { executeWithRetry } from './database-adapter';

// ููุงุณุชุนูุงูุงุช ุงููููุฉ
const users = await executeWithRetry(async () => {
  return await db.select().from(users);
});

// ุงููุธุงู ูุชููู:
// 1. ุฅูุดุงุก ุงุชุตุงู ุฌุฏูุฏ
// 2. ุชูููุฐ ุงูุงุณุชุนูุงู
// 3. ุฅุบูุงู ุงูุงุชุตุงู ุชููุงุฆูุงู
// 4. ุฅุนุงุฏุฉ ุงููุญุงููุฉ ุนูุฏ ุงููุดู
```

## ๐ฏ **ุงูุฎูุงุตุฉ:**
ูุฐุง ุงูุญู ูุญู ุงููุดููุฉ ููุงุฆูุงู ูู ุฎูุงู:
1. **ุงุญุชุฑุงู ุญุฏูุฏ Supabase** ุจุงููุงูู
2. **ุงูุงุชุตุงู ุนูุฏ ุงูุทูุจ** ููุท
3. **ุฅุบูุงู ููุฑู** ููุงุชุตุงูุงุช
4. **ุฅุนุงุฏุฉ ูุญุงููุฉ ุฐููุฉ** ุนูุฏ ุงููุดู

**ุงููุชูุฌุฉ: ูุงุนุฏุฉ ุจูุงูุงุช ูุณุชูุฑุฉ 100% ุจุฏูู ุงููุทุงุน! ๐**